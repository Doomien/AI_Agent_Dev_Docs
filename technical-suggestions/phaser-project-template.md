# Phaser Project Template

A starter template and reference for new Phaser game projects. Clone this structure when starting a new prototype to get consistent project layout, data-driven architecture, and standard tooling out of the box.

**Related:** [tech-stack-recommendations.md](./tech-stack-recommendations.md)

---

## Quick Start

```bash
# Scaffold a new Phaser project
npm create @phaserjs/game@latest my-game
# Select: Vite, TypeScript, No framework

cd my-game
npm install

# Add the project structure conventions
mkdir -p src/game/objects src/game/systems src/utils public/data/entities public/data/levels public/data/config
```

After scaffolding, restructure to match the conventions below. The official template gives you the build tooling; this document adds the organizational patterns.

---

## Directory Structure

```
my-game/
├── index.html                 # Entry HTML (generated by template)
├── package.json
├── tsconfig.json
├── vite.config.ts
│
├── public/
│   ├── assets/                # Static game assets (served as-is by Vite)
│       ├── sprites/           # Individual sprites and sprite sheets
│       │   ├── player.png
│       │   └── player.json    # Atlas JSON (if using texture packer)
│       ├── audio/
│       │   ├── sfx/           # Sound effects (.ogg)
│       │   └── music/         # Background music (.ogg)
│       ├── maps/              # Tiled tilemap exports (.json)
│       ├── fonts/             # Bitmap fonts
│       └── ui/                # UI elements, backgrounds, menus
│   └── data/                  # Runtime JSON loaded by URL
│       ├── entities/          # Entity definitions
│       │   ├── player.json
│       │   ├── enemy-slime.json
│       │   └── item-health-potion.json
│       ├── levels/            # Level/scene configuration
│       │   └── level-01.json
│       └── config/            # Game settings, manifests, difficulty curves
│           ├── asset-manifest.json
│           └── game-settings.json
│
├── src/
│   ├── main.ts                # Application bootstrap
│   │
│   ├── game/
│   │   ├── config.ts          # Phaser.Types.Core.GameConfig
│   │   │
│   │   ├── scenes/            # One file per scene
│   │   │   ├── BootScene.ts       # Minimal setup, load asset manifest
│   │   │   ├── PreloadScene.ts    # Load all game assets, show progress
│   │   │   ├── MenuScene.ts       # Main menu
│   │   │   └── GameScene.ts       # Core gameplay
│   │   │
│   │   ├── objects/           # Game object classes
│   │   │   ├── Player.ts
│   │   │   ├── Enemy.ts
│   │   │   └── Collectible.ts
│   │   │
│   │   └── systems/           # Game logic systems
│   │       ├── CollisionSystem.ts
│   │       ├── SpawnSystem.ts
│   │       └── ScoreSystem.ts
│   │
│   ├── utils/                 # Shared helper functions
│   │   └── math.ts
│   │
│   └── shared/                # (Optional) Cloned shared-game-utils repo
│
└── dist/                      # Production build output (gitignored)
```

---

## Key Files

### `src/main.ts`

Application entry point. Keeps it minimal — just creates the Phaser game instance.

```typescript
import { Game } from 'phaser';
import { gameConfig } from './game/config';

new Game(gameConfig);
```

### `src/game/config.ts`

Central Phaser configuration. All scenes are registered here.

```typescript
import Phaser, { Types } from 'phaser';
import { BootScene } from './scenes/BootScene';
import { PreloadScene } from './scenes/PreloadScene';
import { MenuScene } from './scenes/MenuScene';
import { GameScene } from './scenes/GameScene';

export const gameConfig: Types.Core.GameConfig = {
  type: Phaser.AUTO,
  width: 800,
  height: 600,
  parent: 'game-container',
  backgroundColor: '#1a1a2e',
  physics: {
    default: 'arcade',
    arcade: {
      gravity: { x: 0, y: 0 },
      debug: false,
    },
  },
  scene: [BootScene, PreloadScene, MenuScene, GameScene],
  scale: {
    mode: Phaser.Scale.FIT,
    autoCenter: Phaser.Scale.CENTER_BOTH,
  },
};
```

### `src/game/scenes/BootScene.ts`

First scene to run. Loads the asset manifest and base game settings, then transitions to PreloadScene.

```typescript
import { Scene } from 'phaser';

export class BootScene extends Scene {
  constructor() {
    super('Boot');
  }

  preload() {
    this.load.json('asset-manifest', '/data/config/asset-manifest.json');
    this.load.json('game-settings', '/data/config/game-settings.json');
  }

  create() {
    this.scene.start('Preload');
  }
}
```

### `src/game/scenes/PreloadScene.ts`

Loads all game assets. Shows a loading bar. Transitions to the menu when done.

```typescript
import { Scene } from 'phaser';

export class PreloadScene extends Scene {
  constructor() {
    super('Preload');
  }

  preload() {
    // Loading bar
    const width = this.cameras.main.width;
    const height = this.cameras.main.height;
    const bar = this.add.rectangle(width / 2, height / 2, 0, 20, 0x6366f1);

    this.load.on('progress', (value: number) => {
      bar.width = (width * 0.6) * value;
    });

    // Load game data
    this.load.json('player-data', '/data/entities/player.json');
    this.load.json('level-data', '/data/levels/level-01.json');

    // Load sprites
    this.load.spritesheet('player', 'assets/sprites/player.png', {
      frameWidth: 32,
      frameHeight: 32,
    });

    // Load audio
    this.load.audio('bgm', 'assets/audio/music/bgm-main.ogg');

    // Load tilemaps
    this.load.tilemapTiledJSON('level-01', 'assets/maps/level-01.json');
  }

  create() {
    this.scene.start('Menu');
  }
}
```

### `src/game/scenes/GameScene.ts`

Core gameplay scene. Demonstrates loading entity data from JSON.

```typescript
import { Scene } from 'phaser';

export class GameScene extends Scene {
  constructor() {
    super('Game');
  }

  create() {
    // Load entity definition from cached JSON
    const playerData = this.cache.json.get('player-data');

    // Use data to configure the player
    // playerData.properties.health, playerData.properties.speed, etc.

    // Load level configuration
    const levelData = this.cache.json.get('level-data');

    // Set up gameplay using data-driven definitions
    // ...
  }
}
```

---

## Entity Definition Format

Entity definitions live in `public/data/entities/` as individual JSON files. One file per entity.

### Example: `public/data/entities/player.json`

```json
{
  "id": "player",
  "name": "Player",
  "category": "character",
  "sprite": {
    "source": "assets/sprites/player.png",
    "frameWidth": 32,
    "frameHeight": 32
  },
  "animations": [
    {
      "key": "idle",
      "frames": { "start": 0, "end": 3 },
      "frameRate": 8,
      "loop": true
    },
    {
      "key": "walk",
      "frames": { "start": 4, "end": 11 },
      "frameRate": 12,
      "loop": true
    },
    {
      "key": "attack",
      "frames": { "start": 12, "end": 17 },
      "frameRate": 16,
      "loop": false
    }
  ],
  "properties": {
    "health": 100,
    "speed": 120,
    "damage": 10,
    "jumpForce": 300
  }
}
```

### Example: `public/data/entities/enemy-slime.json`

```json
{
  "id": "enemy-slime",
  "name": "Slime",
  "category": "enemy",
  "sprite": {
    "source": "assets/sprites/enemy-slime.png",
    "frameWidth": 24,
    "frameHeight": 24
  },
  "animations": [
    {
      "key": "idle",
      "frames": { "start": 0, "end": 3 },
      "frameRate": 6,
      "loop": true
    },
    {
      "key": "move",
      "frames": { "start": 4, "end": 7 },
      "frameRate": 8,
      "loop": true
    }
  ],
  "properties": {
    "health": 30,
    "speed": 40,
    "damage": 5,
    "xpValue": 10,
    "spawnWeight": 1.0
  }
}
```

### Example: `public/data/entities/item-health-potion.json`

```json
{
  "id": "item-health-potion",
  "name": "Health Potion",
  "category": "item",
  "sprite": {
    "source": "assets/sprites/items.png",
    "frameWidth": 16,
    "frameHeight": 16
  },
  "animations": [
    {
      "key": "idle",
      "frames": { "start": 0, "end": 3 },
      "frameRate": 4,
      "loop": true
    }
  ],
  "properties": {
    "effectType": "heal",
    "effectAmount": 25,
    "dropWeight": 0.3
  }
}
```

---

## Level Configuration Format

Level definitions live in `public/data/levels/`. They describe entity placements, not tilemap geometry (that lives in the Tiled export).

### Example: `public/data/levels/level-01.json`

```json
{
  "id": "level-01",
  "name": "The Forest",
  "tilemap": "assets/maps/level-01.json",
  "playerSpawn": { "x": 128, "y": 256 },
  "entities": [
    {
      "entityId": "enemy-slime",
      "x": 400,
      "y": 300,
      "properties": {}
    },
    {
      "entityId": "enemy-slime",
      "x": 600,
      "y": 300,
      "properties": {
        "health": 50
      }
    },
    {
      "entityId": "item-health-potion",
      "x": 500,
      "y": 200,
      "properties": {}
    }
  ],
  "triggers": [
    {
      "id": "exit-east",
      "type": "scene-transition",
      "rect": { "x": 780, "y": 0, "w": 20, "h": 600 },
      "target": "level-02"
    }
  ]
}
```

The `properties` object in entity placements allows per-instance overrides of the base entity definition (e.g., a stronger slime in a specific spot).

---

## Game Settings

### Example: `public/data/config/game-settings.json`

```json
{
  "title": "My Game",
  "version": "0.1.0",
  "display": {
    "width": 800,
    "height": 600,
    "pixelArt": true
  },
  "audio": {
    "masterVolume": 0.8,
    "sfxVolume": 1.0,
    "musicVolume": 0.6
  },
  "debug": {
    "showFps": false,
    "showColliders": false
  }
}
```

---

## Naming Conventions

| Element | Convention | Example |
|---------|-----------|---------|
| Files and folders | kebab-case | `enemy-slime.json`, `spawn-system.ts` |
| TypeScript classes | PascalCase | `class GameScene`, `class SpawnSystem` |
| TypeScript functions/variables | camelCase | `createPlayer()`, `spawnDelay` |
| JSON entity IDs | kebab-case | `"id": "enemy-slime"` |
| Scene keys | PascalCase strings | `'Boot'`, `'Preload'`, `'Game'` |
| Asset keys | kebab-case | `'player-idle'`, `'bgm-main'` |
| Phaser animation keys | kebab-case or simple | `'idle'`, `'walk'`, `'attack'` |

---

## .gitignore

```gitignore
node_modules/
dist/
.vite/
*.local
.DS_Store
```

---

## Scripts (package.json)

The Phaser Vite template provides these by default:

```json
{
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview"
  }
}
```

- `npm run dev` — Start development server with hot-reload
- `npm run build` — Production build to `dist/`
- `npm run preview` — Preview the production build locally

---

## Adding Desktop Support (Tauri)

If the project needs desktop packaging, add Tauri:

```bash
npm install -D @tauri-apps/cli
npx tauri init
```

This creates a `src-tauri/` directory. Production builds output native executables to `src-tauri/target/release/bundle/`.

Alternatively, start with the official Phaser Tauri template if desktop is known from the start:

```bash
npm create @phaserjs/game@latest my-game
# Select the Tauri template
```

---

## Checklist for New Projects

When starting a new game project:

- [ ] Scaffold with `npm create @phaserjs/game@latest`
- [ ] Create `public/data/entities/`, `public/data/levels/`, `public/data/config/` directories
- [ ] Create `src/game/objects/`, `src/game/systems/` directories
- [ ] Set up the Boot → Preload → Menu → Game scene flow
- [ ] Define initial entities as JSON files in `public/data/entities/`
- [ ] Initialize git repo with the `.gitignore` above
- [ ] Create a feature branch for development (do not commit to main)
- [ ] (Optional) Clone shared-game-utils into `src/shared/`
- [ ] (Optional) Add Tauri if desktop packaging is needed
